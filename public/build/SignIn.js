webpackJsonp([1],{0:function(e,exports,t){(function(e){function n(e){var t=i(e);if(!t)return null;window.eventData=t,window.userData=e,renderLocationImage(t.location,t.activity||t.summary,t.creator,t.focus_area);var n=r(t.start);renderProgressBar(n)}var a=t(1),r=t(3),o=t(102);t(119);var i=(a.partial(t(120),EVENT_LENGTH,TRANSITION_LENGTH),a.partialRight(t(121),EVENT_LENGTH,TRANSITION_LENGTH,EVENT_INCREMENT)),s=e.env.SCAN_CALLBACK_URL||"https%3A%2F%2Froots-elementary.herokuapp.com";renderProgressBar=function(e){o(".countDown").show();var t=r(Date.now());return e&&t.isAfter(e)?null:void o(".timer").countDown({start_time:t,end_time:e||t.add(1,"ms"),progress:o(".progress-bar"),onComplete:function(){o(".timer").show(),o(".timer").replaceWith('<div class="timer ended">Time\'s Up!</div>')},update_progress:function(e,t){50===Math.floor(e)?o(t).removeClass("progress-bar-success").addClass("progress-bar-warning"):75===Math.floor(e)&&o(t).removeClass("progress-bar-warning").addClass("progress-bar-danger"),t.attr("aria-valuenow",Math.floor(e)),t.css("width",Math.floor(e)+"%"),t.text(Math.floor(e)+"%")}})},renderLocationImage=function(e,t,n,a){e&&(o("#locationImage").empty().append(LOCATION_IMAGES[e.toLowerCase()]),o("#locationText").empty().append(e)),t&&ACTIVITY_IMAGES[t.toLowerCase()]?o("#activityImage").empty().append(ACTIVITY_IMAGES[t.toLowerCase()]):o("#activityImage").empty().append(GET_ACTIVITY(t)),o("#activityText").empty().append(t||""),n?o("#creatorImage").empty().append(CREATOR_IMAGES[n]):a&&(o("#creatorImage").empty().append(FOCUS_AREAS[a]),o("#creatorText").empty().append(a))},getCalendar=function(e){var t=r(Date.now()).startOf("day").toISOString(),i=r(Date.now()).endOf("day").toISOString();gapi.client.request("https://www.googleapis.com/calendar/v3/calendars/"+e.email+"/events/?singleEvents=true&timeMin="+t+"&timeMax="+i+"&orderBy=startTime").execute(function(t){e.calendar=a.map(t.items,function(e){return{eventId:e.id,location:e.location,creator:e.creator.displayName||e.creator.email,start:e.start.dateTime,end:e.end.dateTime,description:e.description,summary:e.summary}}),o.ajax({type:"POST",url:"api/user",data:JSON.stringify(e),contentType:"application/json",success:n}),n(e)})},signinCallback=function(e){e.status.signed_in?(o("#signinButton").hide(),o("#main-container").show(),gapi.client.request("https://www.googleapis.com/plus/v1/people/me?fields=name(familyName%2Cformatted%2CgivenName)%2CdisplayName%2Cemails%2Fvalue%2Cimage%2Furl%2Cid").execute(function(e){var t={id:e.id,name:e.displayName,email:e.emails[0].value,image:e.image.url},n=function(t){t.googleId===e.id&&window.close()},a=io.connect();a.on("SCAN!",n),o("#name").append("<h2>"+e.displayName+"'s Next Step</h2>"),console.log("Scan back URL:"+s),o("#scan-button").attr("href","scan://scan?callback="+s+"/scanredirect/"+e.id),o(".scan-button").show(),getCalendar(t)})):console.log("Sign-in state: "+e.error)}}).call(exports,t(118))},118:function(e,exports){function t(){c=!1,o.length?s=o.concat(s):l=-1,s.length&&n()}function n(){if(!c){var e=setTimeout(t);c=!0;for(var n=s.length;n;){for(o=s,s=[];++l<n;)o&&o[l].run();l=-1,n=s.length}o=null,c=!1,clearTimeout(e)}}function a(e,t){this.fun=e,this.array=t}function r(){}var o,i=e.exports={},s=[],c=!1,l=-1;i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];s.push(new a(e,t)),1!==s.length||c||setTimeout(n,0)},a.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=r,i.addListener=r,i.once=r,i.off=r,i.removeListener=r,i.removeAllListeners=r,i.emit=r,i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}}});